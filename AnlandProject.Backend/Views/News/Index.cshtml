@model List<AnlandProject.Service.BusinessModel.NewsModel>
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_AnlandLayout.cshtml";
}

<div class="page-header">
    <h1 class="page-title">最新消息</h1>
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href='@Url.Action("Index","Home")'>首頁</a></li>
        <li class="breadcrumb-item active">最新消息</li>
    </ol>
    <div class="page-header-actions"></div>
</div>

<div class="page-content container-fluid">

    <!-- 內文編輯區 -->
    <div class="panel panel-bordered">
        <div class="panel-body">
            <div class="row">
                <div class="form-group col-xl-6">
                    <a href='@Url.Action("CreateNews","News")' class="btn btn-md btn-primary" style="margin-right:20px;">
                        <i class="icon wb-plus" aria-hidden="true"></i> 新增訊息
                    </a>
                </div>
                <div class="form-group col-xl-3">
                </div>
            </div>
            <div>
                <table id="newsTable" class="table table-striped table-bordered table-hover table-checkable order-column">
                    <thead>
                        <tr>
                            <th style="width:40px;">編號</th>
                            <th style="width:60px;">主題分類</th>
                            <th style="width:60px;">施政分類</th>
                            <th style="width:60px;">服務分類</th>
                            <th>主題</th>
                            <th style="width:55px;">置頂</th>
                            <th style="width:70px;">發佈日期</th>
                            <th style="width:70px;">公告期限</th>
                            <th style="width:60px;">點閱</th>
                            <th style="width:60px;" class="nosort">管理模式</th>
                        </tr>
                    </thead>
                    <tbody>
                    </tbody>
                </table>
            </div>

        </div>
    </div>
    <!-- model -->
    <div class="modal fade" id="delItem" aria-labelledby="delItem" role="dialog" tabindex="-1" style="display: none;"
         aria-hidden="true">
        <div class="modal-dialog modal-simple modal-center">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">×</span>
                    </button>
                    <h4 class="modal-title">作業訊息</h4>
                </div>
                <div class="modal-body">
                    <p>確定刪除這篇訊息？</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                    <button type="button" class="btn btn-primary" data-dismiss="modal">確定</button>
                </div>
            </div>
        </div>
    </div>
    <!-- /model -->
    <!-- /內文編輯區 -->

</div>

@section scripts{
    <script>
        var urlQueryNews = '@Url.Action("NewsQuery", "News")';

        $(document).ready(function () {
            DatatableBinding();
            //$('#newsTable').DataTable({
            //    //"serverSide": true,
            //    //"processing": true,
            //    //ordering: false,
            //    //searching: false,
            //    "ajax": {
            //        url: urlQueryNews,
            //        type: 'POST'
            //    },
            //    "columns": [
            //        { mDataProp: "ID" },
            //        { mDataProp: "Theme" },
            //        { mDataProp: "Cake" },
            //        { mDataProp: "Service" },
            //        {
            //            mDataProp: "Subject",
            //            render: function (data, type, full, meta) {
            //                return '<a href="news-view.html">' + data + '</a>'
            //            }
            //        },
            //        { mDataProp: "PostOut" },
            //        {
            //            mDataProp: "PostDate",
            //            render: function (data, type, full, meta) {
            //                return DateTimeFormatYYYYMMDD(data);
            //            }
            //        },
            //        {
            //            mDataProp: "EndDate",
            //            render: function (data, type, full, meta) {
            //                if (data == null) {
            //                    return '';
            //                }
            //                return DateTimeFormatYYYYMMDD(data);
            //            }
            //        },
            //        { mDataProp: "Hit" },
            //        {
            //            mDataProp: null,
            //            render: function () {
            //                var tag =
            //                    '<a href="news-edit.html" class="btn btn-pure btn-default p-5 btn-primary">' +
            //                    '<span class="icon wb-pencil" data - toggle="tooltip" data - placement="top" data - original - title="編輯" ></span >' +
            //                    '</a >' +
            //                    '<a href="#delItem" class="btn btn-pure btn-default p-5 btn-warning" data-toggle="modal">' +
            //                    '<span class=" icon wb-trash" data-toggle="tooltip" data-placement="top" data-original-title="刪除"></span>' +
            //                    '</a>'
            //                return tag;
            //            }
            //        }
            //    ],
            //    //language: {
            //    //    aria: {
            //    //        sortAscending: ": activate to sort column ascending",
            //    //        sortDescending: ": activate to sort column descending"
            //    //    },
            //    //    emptyTable: "無資料",
            //    //    info: "顯示 _START_ 到 _END_ 總共 _TOTAL_ 筆",
            //    //    infoEmpty: "無資料",
            //    //    infoFiltered: "(已篩選 1 至 _MAX_ 筆紀錄)",
            //    //    lengthMenu: "每次顯示 _MENU_ 筆",
            //    //    search: "篩選:",
            //    //    zeroRecords: "沒有找到符合的資料",
            //    //    paginate: {
            //    //        previous: "上一頁",
            //    //        next: "下一頁",
            //    //        last: "最後一頁",
            //    //        first: "第一頁",
            //    //        page: "第",
            //    //        pageOf: "頁，總頁數： "
            //    //    }
            //    //},
            //    //bStateSave: !0,
            //    //pagingType: "bootstrap_extended",
            //    //paging: true,
            //    //lengthMenu: [
            //    //    [5, 10, 15, 20, -1],
            //    //    [5, 10, 15, 20, "All"]
            //    //],
            //    //pageLength: 5,
            //    //columnDefs: [{
            //    //    orderable: !1,
            //    //    targets: 'nosort'
            //    //}, {
            //    //    searchable: !1,
            //    //    targets: [0]
            //    //}],
            //    //order: [
            //    //    [1, "asc"]
            //    //]
            //});
        });

        function DatatableBinding() {
            var _tmpOpts = $.extend({}, pfnDataTable.defOpts);
            //_tmpOpts.processing = true;
            //_tmpOpts.serverSide = true;
            _tmpOpts.ajax = {
                "url": urlQueryNews,
                "type": 'POST'                
            };
            _tmpOpts.columns = [
                { mDataProp: "ID" },
                { mDataProp: "Theme" },
                { mDataProp: "Cake" },
                { mDataProp: "Service" },
                {
                    mDataProp: "Subject",
                    render: function (data, type, full, meta) {
                        return '<a href="news-view.html">' + data + '</a>'
                    }
                },
                { mDataProp: "PostOut" },
                {
                    mDataProp: "PostDate",
                    render: function (data, type, full, meta) {
                        return DateTimeFormatYYYYMMDD(data);
                    }
                },
                {
                    mDataProp: "EndDate",
                    render: function (data, type, full, meta) {
                        if (data == null) {
                            return '';
                        }
                        return DateTimeFormatYYYYMMDD(data);
                    }
                },
                { mDataProp: "Hit" },
                {
                    mDataProp: null,
                    render: function () {
                        var tag =
                            '<a href="news-edit.html" class="btn btn-pure btn-default p-5 btn-primary">' +
                            '<span class="icon wb-pencil" data - toggle="tooltip" data - placement="top" data - original - title="編輯" ></span >' +
                            '</a >' +
                            '<a href="#delItem" class="btn btn-pure btn-default p-5 btn-warning" data-toggle="modal">' +
                            '<span class=" icon wb-trash" data-toggle="tooltip" data-placement="top" data-original-title="刪除"></span>' +
                            '</a>'
                        return tag;
                    }
                }
            ];

            if ($.fn.DataTable.isDataTable('#newsTable')) {
                $('#newsTable').DataTable().destroy();
                $('#newsTable  tbody tr').remove();
            }
            $('#newsTable').DataTable(_tmpOpts);
        }
    </script>
}