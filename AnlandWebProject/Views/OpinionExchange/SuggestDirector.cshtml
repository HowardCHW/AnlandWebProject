
@{
    ViewBag.Title = "基隆市安樂地政事務所全球資訊網 - 民意交流-主任信箱";
    Layout = "~/Views/Shared/_LayoutContent.cshtml";
}

@section AdditionalMeta
{
    <link rel="govtwsimpledc.xsd" href="http://www.gov.tw/schema/dc/" title="Dublin Core" />
    <meta name="DC.Title" content="基隆市安樂地政事務所全球資訊網 - 意見交流 - 主任信箱" />
    <meta name="DC.Creator" content="基隆市安樂地政事務所登記課" />
    <meta name="DC.Subject" content="基隆市安樂地政事務所 - 意見交流 - 主任信箱" />
    <meta name="DC.Description" content="意見交流 - 主任信箱" />
    <meta name="DC.Contributor" content="基隆市安樂地政事務所" />
    <meta name="DC.Type" content="文字" />
    <meta name="DC.Format" content="text/html" />
    <meta name="DC.Source" content="基隆市安樂地政事務所" />
    <meta name="DC.Language" content="中文" />
    <meta name="DC.Coverage.t.max" content="2015-04-26" />
    <meta name="DC.Coverage.t.min" content="2010-04-26" />
    <meta name="DC.Publisher" content="基隆市安樂地政事務所" />
    <meta name="DC.Date" content="2010-04-26 10:00 " />
    <meta name="DC.Identifier" content="376570600A" />
    <meta name="DC.Relation" content="http://anleh-land.gov.tw/" />
    <meta name="DC.Rights" content="基隆市安樂地政事務所" />
    <meta name="Category.Theme" content="140" />
    <meta name="Category.Cake" content="CKA" />
    <meta name="Category.Service" content="I60" />
    <meta name="Keywords" content="意見交流, 主任信箱" />
}

@section styles{
    <link rel="stylesheet" href="~/Content/parsley.css" type="text/css" />
    <style>
        .parsley-errors-list {
            /*vertical-align: bottom;*/
            color: red;
        }
    </style>
}

<!-- 公告區 -->
    <div class="container d-print-none">
        <div class="pl-3">
            <a accesskey="C" href="#content" id="content" title="中央內容區塊">:::</a>
            <span class="sr-only">|</span>
            <a class="sr-only sr-only-focusable" href="#footer">轉跳至下方功能區</a>
        </div>
        <noscript>
            <div class="container">
                <div class="row">
                    <div class="card m-3 banner">
                        <div class="card-body p-3">
                            您必須啟用 Javascript，才能以標準檢視使用本網站。不過，Javascript 似乎已停用或不受您的瀏覽器支援。如開啟JavaScript，可得到視覺與特效的最佳瀏覽。
                            <br>列印功能：請按下ctrl+P開啟列印視窗,或由工具列中選擇列印功能。
                            <br>如需要選擇字級大小，IE或Firefox瀏覽器則可利用鍵盤 Ctrl + (+)放大(-)縮小，來選擇適合您的文字大小，如需要回到上一頁可使用瀏覽器提供的
                            Alt+左方向鍵(←)。
                        </div>
                    </div>
                </div>
            </div>
        </noscript>
        <div class="row justify-content-between align-items-center">
            <!-- 麵包屑麵包屑 -->
            <div class="col-lg-6">
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item pathTitle">現在位置</li>
                        <li class="breadcrumb-item">
                            <a href="@Url.Action("Index","Home")">首頁</a>
                        </li>
                        <li class="breadcrumb-item">
                            <a href="@Url.Action("EmailSuggest","OpinionExchange")">民意交流</a>
                        </li>
                        <li class="breadcrumb-item active" aria-current="page">
                            <a href="@Url.Action("SuggestDirector","OpinionExchange")">主任信箱</a>
                        </li>
                    </ol>
                </nav>
            </div>
            <div class="col-lg-6 d-flex justify-content-end align-items-center">
                <div class="btn-toolbar justify-content-between" role="toolbar" aria-label="Toolbar with button groups">
                    <a class="btn btn-fb btn-sm" role="button" role="button" title="網站分享至facebook(另開視窗)" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://anleh-land.gov.tw/">
                        <span class="fab fa-facebook-square"></span>
                    </a>
                    <a class="btn btn-print btn-sm" role="button" title="列印(另開視窗)" target="_blank" href="javascript:print()">
                        <span class="far fa-print"></span>
                    </a>
                    <span class="fontSizeSet">字級設定：</span>
                    <div class="btn-group fontSizeSetGroup btn-group-toggle mr-3" data-toggle="buttons">
                        <label class="btn btn-outline-secondary btn-sm font-small" for="option1">
                            <span class="sr-only">小字型</span>
                            <input type="radio" name="小字型" title="小字型" id="option1" autocomplete="off"> 小
                        </label>
                        <label class="btn btn-outline-secondary btn-sm font-default active" for="option2">
                            <span class="sr-only">中字型</span>
                            <input type="radio" name="中字型" title="中字型" id="option2" autocomplete="off" checked> 中
                        </label>
                        <label class="btn btn-outline-secondary btn-sm font-large" for="option3">
                            <span class="sr-only">大字型</span>
                            <input type="radio" name="大字型" title="大字型" id="option3" autocomplete="off"> 大
                        </label>
                    </div>
                </div>
            </div>
            <!-- /麵包屑 -->
        </div>

        <div class="nav_wrap d-none d-sm-block">
            <ul class="nav nav-pills inner-nav">
                <li><a href="@Url.Action("EmailSuggest","OpinionExchange")" title="前往地政答客問頁面">地政答客問</a></li>
                <li class="active"><a href="@Url.Action("SuggestDirector","OpinionExchange")" title="前往主任信箱頁面">主任信箱</a></li>
                <li><a href="@Url.Action("Questionnaire","OpinionExchange")" title="前往網路投票頁面">網路投票</a></li>
                <li><a href="@Url.Action("InnovationProposal","OpinionExchange")" title="前往民眾參與創新提案頁面">民眾參與創新提案</a></li>
            </ul>
        </div>
    </div>
<!-- 內文區 -->
<div class="container">
    <div class="row">
        <div class="card ml-3 mr-3 mt-3 subContent">
            <div class="card-body">
                <div class="markTag"></div>
                <h2>主任信箱</h2>
                <noscript>
                    <div class="container">
                        <div class="row">
                            <div class="card m-3 banner">
                                <div class="card-body p-3">
                                    您必須啟用 Javascript，才能以標準檢視使用頁籤功能。不過，Javascript 似乎已停用或不受您的瀏覽器支援。請開啟JavaScript或使用支援JavaScript瀏覽器，以獲得正確的訊息顯示。
                                </div>
                            </div>
                        </div>
                    </div>
                </noscript>
                <div class="container pl-5 pt-3">
                    <div class="row">
                        <div class="col-lg-12" id="sec02">
                            <ul class="nav nav-pills justify-content-end" id="myTab" role="tablist">
                                <li class="nav-item">
                                    <a class="nav-link link-success active" id="correct1-tab" data-toggle="tab" href="#correct1" role="tab" aria-controls="correct1"
                                       aria-selected="false">
                                        <span class="fas fa-file-check"></span> 主任信箱答覆情形
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link link-success" id="correct2-tab" data-toggle="tab" href="#correct2" role="tab" aria-controls="correct2"
                                       aria-selected="false">
                                        <span class="fas fa-edit"></span> 主任信箱填送
                                    </a>
                                </li>
                            </ul>

                            <div class="tab-content" id="myTabContent">
                                <div class="tab-pane fade show active" id="correct1" role="tabpanel" aria-labelledby="correct1-tab">
                                    <h3 class="pl-0">
                                        <span class="fas fa-bookmark"></span> 主任信箱答覆情形
                                    </h3>
                                    <div class="col-md-12 pl-0">
                                        <noscript>
                                            <div class="container">
                                                <div class="row">
                                                    <div class="card m-3 banner">
                                                        <div class="card-body p-3">
                                                            您必須啟用 Javascript，才能以標準檢視使用本動態表格功能。不過，Javascript 似乎已停用或不受您的瀏覽器支援。請開啟JavaScript或使用支援JavaScript瀏覽器，以獲得正確的訊息顯示。
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </noscript>
                                        <table id="directortable" class="table table-striped table-hover border-bottom rwd-table" summary="主任信箱答覆情形列表，為5直欄設計，第1直欄為列管編號，第2直欄為主題，第3直欄為寄信日期，第4直欄為回覆情形，第5直欄為回覆日期。">
                                            <caption class="sr-only">
                                                主任信箱答覆情形列表
                                            </caption>
                                            <thead>
                                                <tr class="bg-brown">
                                                    <th class="text-nowrap" scope="col">列管編號</th>
                                                    <th class="text-nowrap" scope="col">主題</th>
                                                    <th class="text-nowrap" scope="col">留言日期</th>
                                                    <th class="text-nowrap" scope="col">回覆情形</th>
                                                    <th class="text-nowrap" scope="col">回覆日期</th>
                                                </tr>
                                            </thead>
                                        </table>
                                        <p class="darkblue pl-0">注意事項：</p>
                                        <ol class="textOl-list1">
                                            <li>所傳信件內容為廣告、或未留正確E-MAIL帳號、或惡意謾罵攻訐者，皆不予以處理。</li>
                                            <li>詳細回覆內容皆由相關承辦人員以電子郵件回覆，惟內容如涉及個人隱私者，除由承辦人另行審慎處理外，本網站不予刊登。</li>
                                        </ol>
                                    </div>
                                </div>
                                <div class="tab-pane fade" id="correct2" role="tabpanel" aria-labelledby="correct2-tab">
                                    <h3 class="pl-0">
                                        <span class="fas fa-bookmark"></span> 主任信箱填送
                                    </h3>
                                    <div class="col-md-12pl-0">
                                        @*<form name="suggestForm" action="suggest.html" onsubmit="return validateSuggestForm()" method="post">*@
                                        @using (Ajax.BeginForm("SuggestDirectorSave", "OpinionExchange", null, new AjaxOptions { HttpMethod = "POST", OnSuccess = "SuccessMessage(data)", OnFailure = "FailMessage" }, new { @id = "sendDRSuggestForm" }))
                                        {
                                            @Html.AntiForgeryToken()
                                            <table class="table table-hover border-bottom rwd-table" summary="民意信箱填送表格，為6橫欄設計，第1橫欄為主題，第2橫欄為真實姓名，第3橫欄為電話，第4橫欄為電子信箱，第5橫欄為問題類型，第6橫欄為內容。">
                                                <caption class="sr-only">
                                                    民眾意見填送
                                                </caption>
                                                <tr>
                                                    <th width="20%" scope="row" class="bg-brown text-nowrap text-center">
                                                        <label for="topic"><span>(必填)</span> 主　　題</label>
                                                    </th>
                                                    <td data-th="主題">
                                                        <input name="MsgSubject" type="text" class="form-control" id="topic" placeholder="主題" title="請填寫意見標題" required data-parsley-required-message="請填寫意見標題！">
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <th width="20%" scope="row" class="bg-brown text-nowrap text-center">
                                                        <label for="name"><span>(必填)</span> 真實姓名</label>
                                                    </th>
                                                    <td data-th="真實姓名">
                                                        <input name="MsgName" type="text" class="form-control" size="15" id="name" placeholder="姓名" title="請填寫真實姓名" required data-parsley-required-message="請填寫真實姓名！">
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <th width="20%" scope="row" class="bg-brown text-nowrap text-center">
                                                        <label for="tel">電　　話</label>
                                                    </th>
                                                    <td data-th="電話">
                                                        <input name="MsgTel" type="text" class="form-control" size="15" id="tel" placeholder="電話" title="請填寫電話">
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <th width="20%" scope="row" class="bg-brown text-nowrap text-center">
                                                        <label for="email"><span>(必填)</span> 電子信箱</label>
                                                    </th>
                                                    <td data-th="電子信箱">
                                                        <input name="MsgEmail" type="text" class="form-control" size="40" id="email" placeholder="電子信箱" title="請填寫電子信箱" required data-parsley-required-message="請填寫電子郵件！" data-parsley-type="email" data-parsley-type-message="電子郵件信箱格式錯誤，請重新檢查！">
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <th width="20%" scope="row" class="bg-brown text-nowrap text-center">
                                                        <label for="contents"><span>(必填)</span> 內　　文</label>
                                                    </th>
                                                    <td data-th="內文">
                                                        <textarea name="MsgContent" cols="60" rows="6" class="form-control" id="contents" placeholder="內文" title="請填寫您的問題或建議" required data-parsley-required-message="請填寫內文！"></textarea>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td colspan="2" class="text-nowrap text-right" scope="row">
                                                        <button type="reset" class="btn btn-default">重填</button>
                                                        <button id="btnSave" type="button" class="btn btn-primary">
                                                            寄出
                                                            <span class="fab fa-telegram-plane"></span>
                                                        </button>
                                                    </td>
                                                </tr>
                                            </table>
                                        }
                                        @*</form>*@

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- /內文區 -->

@section scripts{
    <script src="~/Scripts/Parsley/parsley.js"></script>
    <script>
        var urlQueryNews = '@Url.Action("SuggestDirectorQuery", "OpinionExchange")';
        $(document).ready(function () {
            DatatableBinding();

            $('#btnSave').on('click', function () {
                $('#sendDRSuggestForm').parsley().validate();
                if ($('#sendDRSuggestForm').parsley().isValid()) {
                    $('#sendDRSuggestForm').submit();
                }
            });
        });

        function DatatableBinding() {
            $('#directortable').DataTable({
                ajax: {
                    "url": urlQueryNews,
                    "type": 'POST'
                },
                language: {
                    "processing": "處理中...",
                    "loadingRecords": "載入中...",
                    "lengthMenu": "顯示 _MENU_ 筆結果",
                    "zeroRecords": "沒有符合的結果",
                    "info": "顯示第 _START_ 至 _END_ 筆結果，共 _TOTAL_ 筆",
                    "infoEmpty": "顯示第 0 至 0 筆結果，共 0 筆",
                    "infoFiltered": "(從 _MAX_ 筆結果中過濾)",
                    "infoPostFix": "",
                    "search": "搜尋:",
                    "searchPlaceholder": "請輸入關鍵字",
                    "paginate": {
                        "first": "第一頁",
                        "previous": "上一頁",
                        "next": "下一頁",
                        "last": "最後一頁"
                    },
                    "aria": {
                        "sortAscending": ": 升冪排列",
                        "sortDescending": ": 降冪排列"
                    }
                },
                pagingType: "full_numbers",
                ordering: false,
                columnDefs: [
                    {
                        targets: [0, 1, 2, 3, 4],
                        createdCell: function (td, cellData, rowData, row, col) {
                            if (col == 0) {
                                $(td).attr('data-th', '列管編號');
                            }
                            if (col == 1) {
                                $(td).attr('data-th', '主題');
                            }
                            if (col == 2) {
                                $(td).attr('data-th', '留言日期');
                            }
                            if (col == 3) {
                                $(td).attr('data-th', '回覆情形');
                            }
                            if (col == 4) {
                                $(td).attr('data-th', '回覆日期');
                            }
                        }
                    }
                ],
                columns: [
                    { mDataProp: "No" },
                    {
                        mDataProp: "MsgSubject",
                        render: function (data, type, full, meta) {
                            return '<a href="../OpinionExchange/SuggestDRDetail/' + full.No + '">' + data + '</a>'
                        }
                    },
                    {
                        mDataProp: "MsgDate",
                        render: function (data, type, full, meta) {
                            return moment(data).format('YYYY/MM/DD');
                        }
                    },
                    {
                        mDataProp: "RpyDate",
                        render: function (data, type, full, meta) {
                            if (data == null) {
                                return '未回覆';
                            } else {
                                return '<span class="red">已回覆</span>';
                            }
                        }
                    },
                    {
                        mDataProp: "RpyDate",
                        render: function (data, type, full, meta) {
                            if (data == null) {
                                return '';
                            }
                            return moment(data).format('YYYY/MM/DD');
                        }
                    }
                ]
            });
        }

        function SuccessMessage(result) {
            if (result) {
                var url = '/OpinionExchange/SuggestDirector';
                SuccessMSGAfterAction("送出成功", url, 1000);
            } else {
                ErrorMSG('送出失敗');
            }
        }

        function FailMessage() {
            ErrorMSG('送出失敗');
        }
    </script>
}